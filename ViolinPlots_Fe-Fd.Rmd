---
title: "Graphics_optimizationAlgorithm"
author: "Marco FLoresCoronado"
date: "5/26/2023"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#install.packages("pacman")
library(pacman)
pacman::p_load(dplyr, ggplot2, tidyr, stringr)
```

```{r}
subdirectory1200 <- "MaxFd_TR1200"
name1200 <- paste("./", subdirectory1200, sep = "")
#"~/mflores/"
OVFFiles1200 <- list.files(name1200,pattern='OVF', full.names = T)
eventsFiles1200 <- list.files(name1200,pattern='nEvents', full.names = T)
#originFiles <- paste(originFiles, subdirectory, sep = "")
#xfiles <- str_remove_all(originFiles,"nEvents.csv")
#xfiles <- unique(xfiles)
subdirectory1500 <- "MaxFd_TR1500"
name1500 <- paste("./", subdirectory1500, sep = "")
#"~/mflores/"
OVFFiles1500 <- list.files(name1500,pattern='OVF', full.names = T)
eventsFiles1500 <- list.files(name1500,pattern='nEvents', full.names = T)

```
```{r}
#opening OVF files and binding them together
for (i in 1:length(OVFFiles1200)){
OVF_lists <- read.csv2(OVFFiles1200[i] , header = F, sep = ",")
  if (i==1){
   OVF_df1200 <- OVF_lists
  }
  else
  {OVF_df1200 <- rbind(OVF_df1200, OVF_lists) }
}
for (i in 1:length(OVFFiles1500)){
OVF_lists <- read.csv2(OVFFiles1500[i] , header = F, sep = ",")
  if (i==1){
   OVF_df1500 <- OVF_lists
  }
  else
  {OVF_df1500 <- rbind(OVF_df1500, OVF_lists) }
}
```

```{r}
for (i in 1:length(eventsFiles1200)){
events_lists <- read.csv2(eventsFiles1200[i] , header = F, sep = ",")
  if (i==1){
   events_df1200 <- events_lists
  }
  else
  {events_df1200 <- rbind(events_df1200, events_lists) }
}
for (i in 1:length(eventsFiles1500)){
events_lists <- read.csv2(eventsFiles1500[i] , header = F, sep = ",")
  if (i==1){
   events_df1500 <- events_lists
  }
  else
  {events_df1500 <- rbind(events_df1500, events_lists) }
}
```

```{r}
events_df <- data.frame(events_df1200$V1,"1200")
names(events_df) <- c("events","TR")
tmp.df <- data.frame(events_df1500$V1,"1500")
names(tmp.df) <- c("events","TR")
events_df <- rbind(events_df,tmp.df)
```

```{r}
#build violin plots 
dp <- ggplot(events_df, aes(x=TR, y=events )) + 
  geom_violin(trim=FALSE)+
  geom_boxplot(width=0.1, fill="white")+
  labs(title="Efficiency achieved in Genetic algorithm", y = "Control trials excess")
dp + theme_classic()
```
```{r}
OVF_df <- data.frame(OVF_df1200$V1,"1200")
names(OVF_df) <- c("OVF","TR")
tmp.df <- data.frame(OVF_df1500$V1,"1500")
names(tmp.df) <- c("OVF","TR")
OVF_df <- rbind(OVF_df,tmp.df)
OVF_df$OVF <- as.numeric(OVF_df$OVF)
```

```{r}
#build violin plots 
dp <- ggplot(OVF_df, aes(x=TR, y=OVF)) + 
  geom_violin(trim=FALSE)+
  geom_boxplot(width=0.1, fill="white")+
  labs(title="Efficiency achieved in Genetic algorithm", y = "OVF")
dp + theme_classic()
```
